(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     11381,        331]
NotebookOptionsPosition[     10593,        309]
NotebookOutlinePosition[     10984,        325]
CellTagsIndexPosition[     10941,        322]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["Perturbation in Curved universe with matter", "Input",
 CellChangeTimes->{{3.9263932945563717`*^9, 3.926393296155257*^9}, {
  3.926393326520618*^9, 3.92639333316991*^9}, {3.926394839942863*^9, 
  3.926394862556696*^9}},
 FormatType->
  "TextForm",ExpressionUUID->"57b94d17-4529-44e7-9c18-01420ca32746"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]", "[", "a_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{"g", "[", "a", "]"}], "]"}], "/", 
     RowBox[{"a", "^", "3"}]}], " ", 
    RowBox[{"Exp", "[", 
     RowBox[{"I", " ", "*", 
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", "b", "]"}], "/", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"1", "+", 
            RowBox[{"b", "^", "4"}], "-", 
            RowBox[{"2", "kc", " ", 
             RowBox[{"b", "^", "2"}]}], "+", 
            RowBox[{"m", " ", "b"}]}], "]"}]}], "/", 
         RowBox[{"g", "[", "b", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"b", ",", "0", ",", "a"}], "}"}]}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"a", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"m", " ", "a"}], "-", 
       RowBox[{"2", "kc", " ", 
        RowBox[{"a", "^", "2"}]}], "+", 
       RowBox[{"a", "^", "4"}]}], ")"}], 
     RowBox[{
      RowBox[{"\[Phi]", "''"}], "[", "a", "]"}]}], "+", 
    RowBox[{"2", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", 
        RowBox[{"a", "^", "4"}]}], "+", "2", "+", 
       RowBox[{"2", "m", " ", "a"}], "-", 
       RowBox[{"5", " ", "kc", " ", 
        RowBox[{"a", "^", "2"}]}]}], ")"}], 
     RowBox[{
      RowBox[{"\[Phi]", "'"}], "[", "a", "]"}]}], "+", 
    RowBox[{"a", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", 
        RowBox[{"a", "^", "2"}]}], "+", 
       RowBox[{"k", "^", "2"}]}], ")"}], 
     RowBox[{"\[Phi]", "[", "a", "]"}]}]}], "==", "0"}], "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.9263932854931498`*^9, 3.926393286180279*^9}, {
  3.9263933898321133`*^9, 3.926393452209775*^9}, {3.92639349885334*^9, 
  3.926393562970809*^9}, {3.926393624151462*^9, 3.9263936361395693`*^9}, {
  3.92639387506627*^9, 3.926393896695744*^9}, {3.926393930899065*^9, 
  3.926393952710511*^9}, {3.926394300632256*^9, 3.926394310959166*^9}, {
  3.9263949943805323`*^9, 3.926395018664215*^9}, {3.926395084775914*^9, 
  3.92639508769172*^9}, {3.926395838528494*^9, 3.926395859586664*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"af845d2f-f3a4-4689-a888-3570ad538264"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", 
    RowBox[{"a", " ", 
     SqrtBox[
      RowBox[{"1", "+", 
       RowBox[{"a", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["a", "3"], "-", 
          RowBox[{"2", " ", "a", " ", "kc"}], "+", "m"}], ")"}]}]}]], " ", 
     SqrtBox[
      RowBox[{"g", "[", "a", "]"}]]}]], 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{
       SubsuperscriptBox["\[Integral]", "0", "a"], 
       RowBox[{
        FractionBox[
         RowBox[{"f", "[", "b", "]"}], 
         RowBox[{
          SqrtBox[
           RowBox[{"1", "+", 
            RowBox[{"b", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["b", "3"], "-", 
               RowBox[{"2", " ", "b", " ", "kc"}], "+", "m"}], ")"}]}]}]], 
          " ", 
          RowBox[{"g", "[", "b", "]"}]}]], 
        RowBox[{"\[DifferentialD]", "b"}]}]}]}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"4", " ", "a", " ", 
       SqrtBox[
        RowBox[{"1", "+", 
         RowBox[{"a", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["a", "3"], "-", 
            RowBox[{"2", " ", "a", " ", "kc"}], "+", "m"}], ")"}]}]}]], " ", 
       SuperscriptBox[
        RowBox[{"f", "[", "a", "]"}], "2"]}], "+", 
      RowBox[{"2", " ", "\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{"4", "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["a", "4"]}], "-", 
         RowBox[{"8", " ", 
          SuperscriptBox["a", "2"], " ", "kc"}], "+", 
         RowBox[{"5", " ", "a", " ", "m"}]}], ")"}], " ", 
       RowBox[{"f", "[", "a", "]"}], " ", 
       RowBox[{"g", "[", "a", "]"}]}], "-", 
      RowBox[{"4", " ", "a", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", 
          SuperscriptBox["a", "2"]}], "+", 
         SuperscriptBox["k", "2"], "+", 
         RowBox[{"6", " ", "kc"}]}], ")"}], " ", 
       SqrtBox[
        RowBox[{"1", "+", 
         RowBox[{"a", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["a", "3"], "-", 
            RowBox[{"2", " ", "a", " ", "kc"}], "+", "m"}], ")"}]}]}]], " ", 
       SuperscriptBox[
        RowBox[{"g", "[", "a", "]"}], "2"]}], "+", 
      RowBox[{"a", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"a", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["a", "3"], "-", 
             RowBox[{"2", " ", "a", " ", "kc"}], "+", "m"}], ")"}]}]}], ")"}], 
        RowBox[{"3", "/", "2"}]], " ", 
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["g", "\[Prime]",
          MultilineFunction->None], "[", "a", "]"}], "2"]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"g", "[", "a", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"a", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["a", "3"], "-", 
               RowBox[{"2", " ", "a", " ", "kc"}], "+", "m"}], ")"}]}]}], 
           ")"}], " ", 
          RowBox[{
           SuperscriptBox["f", "\[Prime]",
            MultilineFunction->None], "[", "a", "]"}]}], "+", 
         RowBox[{
          SqrtBox[
           RowBox[{"1", "+", 
            RowBox[{"a", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["a", "3"], "-", 
               RowBox[{"2", " ", "a", " ", "kc"}], "+", "m"}], ")"}]}]}]], 
          " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{
                SuperscriptBox["a", "2"], " ", "kc"}], "-", 
               RowBox[{"a", " ", "m"}]}], ")"}], " ", 
             RowBox[{
              SuperscriptBox["g", "\[Prime]",
               MultilineFunction->None], "[", "a", "]"}]}], "+", 
            RowBox[{"a", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"a", " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["a", "3"], "-", 
                  RowBox[{"2", " ", "a", " ", "kc"}], "+", "m"}], ")"}]}]}], 
              ")"}], " ", 
             RowBox[{
              SuperscriptBox["g", "\[Prime]\[Prime]",
               MultilineFunction->None], "[", "a", "]"}]}]}], ")"}]}]}], 
        ")"}]}]}], ")"}]}]}], "\[Equal]", "0"}]], "Output",
 CellChangeTimes->{{3.926393612558865*^9, 3.926393637515123*^9}, 
   3.9263944079076767`*^9, {3.926395000655925*^9, 3.926395019904026*^9}, 
   3.926395097624034*^9, 3.926395712904089*^9, 3.926395745614748*^9, {
   3.9263958431484537`*^9, 3.926395881723488*^9}},
 CellLabel->"Out[30]=",ExpressionUUID->"c6d5bca1-26dc-493f-952c-3546bc1c28af"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"DSolve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"2", "a", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"a", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", "^", "3"}], "-", 
           RowBox[{"2", "a", " ", "kc"}], " ", "+", "m"}], ")"}]}]}], ")"}], 
      RowBox[{
       RowBox[{"f", "'"}], "[", "a", "]"}]}], "==", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"4", "+", 
        RowBox[{"4", " ", 
         RowBox[{"a", "^", "4"}]}], " ", "-", 
        RowBox[{"8", 
         RowBox[{"a", "^", "2"}], " ", "k"}], "+", 
        RowBox[{"5", "a", " ", "m"}]}], ")"}], 
      RowBox[{"f", "[", "a", "]"}]}]}], ",", " ", 
    RowBox[{"f", "[", "a", "]"}], ",", " ", "a"}], "]"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.926396019328964*^9, 3.926396136567336*^9}, 
   3.926396171018222*^9},
 CellLabel->"In[33]:=",ExpressionUUID->"7551e565-43c1-4b33-b9c9-0d439ea94c9d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"f", "[", "a", "]"}], "\[Rule]", 
    RowBox[{
     SuperscriptBox["a", "2"], " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"RootSum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"1", "+", 
           RowBox[{"m", " ", "#1"}], "-", 
           RowBox[{"2", " ", "kc", " ", 
            SuperscriptBox["#1", "2"]}], "+", 
           SuperscriptBox["#1", "4"]}], "&"}], ",", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"m", " ", 
             RowBox[{"Log", "[", 
              RowBox[{"a", "-", "#1"}], "]"}]}], "-", 
            RowBox[{"8", " ", "k", " ", 
             RowBox[{"Log", "[", 
              RowBox[{"a", "-", "#1"}], "]"}], " ", "#1"}], "+", 
            RowBox[{"8", " ", "kc", " ", 
             RowBox[{"Log", "[", 
              RowBox[{"a", "-", "#1"}], "]"}], " ", "#1"}]}], 
           RowBox[{"m", "-", 
            RowBox[{"4", " ", "kc", " ", "#1"}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["#1", "3"]}]}]], "&"}]}], "]"}]}]], " ", 
     TemplateBox[{"1"},
      "C"]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.926396161608446*^9, 3.926396171504949*^9}},
 CellLabel->"Out[33]=",ExpressionUUID->"a84b40dc-2db3-488e-9784-e85ff9df11af"]
}, Open  ]]
},
WindowSize->{1110, 605.25},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"13.3 for Linux x86 (64-bit) (June 3, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"ad426e25-c8a5-4964-85b2-7467442dda39"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 308, 5, 29, "Input",ExpressionUUID->"57b94d17-4529-44e7-9c18-01420ca32746"],
Cell[CellGroupData[{
Cell[891, 29, 2293, 63, 54, "Input",ExpressionUUID->"af845d2f-f3a4-4689-a888-3570ad538264"],
Cell[3187, 94, 4996, 140, 126, "Output",ExpressionUUID->"c6d5bca1-26dc-493f-952c-3546bc1c28af"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8220, 239, 974, 28, 31, "Input",ExpressionUUID->"7551e565-43c1-4b33-b9c9-0d439ea94c9d"],
Cell[9197, 269, 1380, 37, 102, "Output",ExpressionUUID->"a84b40dc-2db3-488e-9784-e85ff9df11af"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

